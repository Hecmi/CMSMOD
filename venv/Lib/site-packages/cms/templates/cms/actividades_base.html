{% extends "admin/base_site.html" %}
{% load i18n l10n cms_tags cms_js_tags %}
{% load i18n static %}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/js/all.min.js"></script>

{% block extrastyle %}<link rel="stylesheet" href="{% static "admin/css/login.css" %}">
{{ form.media }}
{% endblock %}

{% block usertools %}{% endblock %}

{% block nav-global %}{% endblock %}

{% block nav-sidebar %}{% endblock %}

{% block content_title %}{% endblock %}

{% block nav-breadcrumbs %}{% endblock %}

{% block content %}

<form id="form_d" action="{{ app_path }}" method="POST">
  <form id="form_e" action="{% url 'save' 1 %}" method="POST">
    {% csrf_token %}
    {% if error %}
        <div class="form-row">
            {{ error }}           
        </div>
    {% endif %}

    <label><b>TIPO:<b></label>
    <select type="hidden" id="IS_DYNAMIC" name="IS_DYNAMIC" >
        <option value="True">Dinámico</option>
        <option value="False">Aleatorio</option>
    </select>
    <br>
    
    {% if grupos %}
         <label><b>ASIGNACIONES:<b></label>
          <table style="width: 100%;  border: 1px solid grey;">
            <thead style="border: 1px solid grey;">
              <th>{% trans 'Número de grupo:' %}</th>
              <th>{% trans 'Tarea:' %}</th>
              <th>{% trans 'Usuario:' %}</th>
              <th>{% trans 'Calificación:' %}</th>
            </thead>
            <tbody>
              {% for grupo in grupos %}
              {% for usuario in grupo.estudiantes %}
                <tr style="border: 1px solid grey;">
                    <td name="p_group_number">{{forloop.parentloop.counter}}</td>
                    <td name="p_task_name">
                      {% for tarea in grupo.tarea %}                      
                        {{tarea}}
                      {% endfor %}
                    </td>
                    <td>
                      <input name="p_username" type="text" min=0 max=10 value="{{usuario}}" />                      
                    </td>
                    <td>
                      <input name="p_calification" type="number" min=0 max=10 value="0" />
                    </td>
                </tr>
                  {% endfor %}
              {% endfor %}
            </tbody>          
        </table>            
    {% endif %}


    <label><b>CANTIDAD DE GRUPOS:<b></label>
    <input type="text" name="CANTIDAD_GRUPOS" value="1" />        
    <br>

    <label><b>USUARIOS:<b></label>
    {% for usuario in usuarios %}
        <input type="text" name="usuario-{{forloop.counter0}}" value="{{usuario}}" />        
    {% endfor %}
    {% for id in ids %}
        <input type="hidden" name="usuarioid-{{forloop.counter0}}" value="{{id}}" />        
    {% endfor %}
        
    <br>
    <input type="hidden" name="CANTIDAD_ESTUDIANTES" value="{{lenusuarios}}"/>
    <br>
    <label><b>ACTIVIDADES:<b></label>
    <textarea name="ACTIVIDADES" rows=5></textarea>
  
  <style>
    .form-row-mod {
      display: flex;
      align-items: center;
    }

    #ver {
      padding: 8px;
      width: 100%;
      box-sizing: border-box;
    }
  
    .password-wrapper {
      flex-grow: 1;
    }
  
    button {
      margin-left: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      border: none;
      background: none;
      padding: 0;
    }

    .fila {
      justify-content: space-between;
      display: flex;
    }

    .item {
      padding: 10px;
    }
  </style>

  <div class="submit-row">
      {% if grupos %}
      <div class="fila">
        <input name="Save" type="submit" class="cms-btn-action" 
          data-url="{% url 'save' 1 %}" value="{% translate 'Guardar' %}">        
      </div>
      {% endif %}
      {% if existe_grupos %}
      <div class="fila">
        <a class="cms-btn-action" 
        href="{% url 'get_groups' 1 %}">Ver grupos</a>        
      </div>
      {% endif %}
      <div class="fila">
        <input type="submit" class="cms-btn-action" value="{% translate 'Generar' %}">        
      </div>
  </div> 

  </form>
</form>

{% endblock %}
