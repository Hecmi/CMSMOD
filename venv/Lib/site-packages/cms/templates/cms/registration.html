{% extends "admin/base_site.html" %}
{% load i18n static %}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/js/all.min.js"></script>

{% block extrastyle %}{{ block.super }}<link rel="stylesheet" href="{% static "admin/css/login.css" %}">
{{ form.media }}
{% endblock %}

{% load static %}

{% block bodyclass %}{{ block.super }} login{% endblock %}

{% block usertools %}{% endblock %}

{% block nav-global %}{% endblock %}

{% block nav-sidebar %}{% endblock %}

{% block content_title %}{% endblock %}

{% block nav-breadcrumbs %}{% endblock %}

{% block content %}
{% if form.errors and not form.non_field_errors %}
<p class="errornote">
{% blocktranslate count counter=form.errors.items|length %}Por favor corrige el siguiente error.{% plural %}Por favor corrija los siguientes errores.{% endblocktranslate %}
</p>
{% endif %}

{% if form.non_field_errors %}
{% for error in form.non_field_errors %}
<p class="errornote">
    {{ error }}
</p>
{% endfor %}
{% endif %}

<div id="content-main">

<form action="{{ app_path }}" method="post" id="login-form">{% csrf_token %}
  <style>
    .centered-image {
      display: block;
      margin: auto;
      width: 200px;
      height: 200px;
    }
  </style>
  
  <img class="centered-image" src="https://www.iconpacks.net/icons/2/free-user-icon-3296-thumb.png"> 
  <div class="form-row errornote">
    {% if form.errors %}
      <ul>
        {% for field, error_list in form.errors.items %}
          {% for error in error_list %}
          {% if error == 'This password is too short. It must contain at least 8 characters.' %}
            <li>La contraseña es demasiado corta, debe contener por lo menos 8 caracteres.</li>
          {%endif%}
          {% if error == 'This password is too common.' %}
            <li>La contraseña ingresada es demasiada común</li>
          {%endif%}
          {% if error == 'This password is entirely numeric.' %}
            <li>La contraseña debe contener una combinación de caracteres, no solo números.</li>
          {%endif%}
          {% if error == 'The two password fields didn’t match.' %}
            <li>Las contraseñas ingresadas no son iguales.</li>
          {%endif%}
          {% endfor %}
        {% endfor %}
      </ul>
    {% endif %}
    <br>
  </div>
  <label class=""><b>Usuario:<b></label>
  {% comment %} {{ form.username.label_tag }}  {% endcomment %}
  {{ formUsuario.username }}
  <div class="form-row">
    <label class=""><b>Contraseña:</b></label>    
  </div>
  <div class="fila">
    {{ formUsuario.password1 }}
    <button class="item" type="button" style="margin-left: 5%; flex-basis: 10%;" id="ver" onclick="togglePasswordVisibility('id_password1', 'iconPassword1')">
      <img id="iconPassword1"  width="20px" src="https://icons.veryicon.com/png/o/application/love-other-car-app-icon/eye-16.png" class='fas fa-eye-slash'></img>
    </button>
  </div>
  <div class="form-row">
    <label class=""><b>Confirmar contraseña:</b></label>
  </div>
  <div class="fila">
    {{ formUsuario.password2 }}
    <button class="item" type="button" style="margin-left: 5%; flex-basis: 10%;" id="ver" onclick="togglePasswordVisibility('id_password2', 'iconPassword2')">
      <img  id="iconPassword2" width="20px" src="https://icons.veryicon.com/png/o/application/love-other-car-app-icon/eye-16.png" class='fas fa-eye-slash'></img>
    </button>
  </div>
  <div class="form-row">
    <div class="fila">
     <input type="hidden" name="next" value="{{ next }}">
    </div>
  </div>
  <style>
    .form-row-mod {
      display: flex;
      align-items: center;
    }

    #ver {
      padding: 8px;
      width: 100%;
      box-sizing: border-box;
    }
  
    .password-wrapper {
      flex-grow: 1;
    }
  
    button {
      margin-left: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      border: none;
      background: none;
      padding: 0;
    }

    .fila {
      justify-content: space-between;
      display: flex;
    }

    .item {
      padding: 10px;
    }
  </style>

<script>
    function togglePasswordVisibility(id_boton, ver) {
        var passwordInput = document.getElementById(id_boton);
        var toggleButton = document.getElementById(ver);

        if (passwordInput.type === "password") {
          passwordInput.type = "text";
          toggleButton.style.backgroundImage = "url('https://icons.veryicon.com/png/o/photographic/ant-design-official-icon-library/eye-close-1.png')";
          toggleButton.style.content = "url('https://icons.veryicon.com/png/o/photographic/ant-design-official-icon-library/eye-close-1.png')";
        } else {
          passwordInput.type = "password";
          toggleButton.style.backgroundImage = "url('https://icons.veryicon.com/png/o/application/love-other-car-app-icon/eye-16.png')";
          toggleButton.style.content = "url('https://icons.veryicon.com/png/o/application/love-other-car-app-icon/eye-16.png')";
        }
        toggleButton.style.display = 'inline-block';
        toggleButton.style.width = '20px'; // Ancho predefinido
        toggleButton.style.height = '20px'; // Altura predefinida
    }
</script>

  {% url 'admin_password_reset' as password_reset_url %}
  {% if password_reset_url %}
  <div class="password-reset-link">
    <a href="{{ password_reset_url }}">{% translate '¿Olvidaste tu usuario o contraseña?' %}</a>
  </div>
  {% endif %}
  <div class="submit-row">
      <div class="fila">
        <a href="{% url 'admin:index' %}">{% translate 'Regresar' %}</a>
        <input type="submit" value="{% translate 'Registrarme' %}">        
    </div>
  </div> 
</form>

</div>
{% endblock %}
